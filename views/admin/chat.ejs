<% include partials/header %>
<!-- <link href="stylesheets/inbox.css" rel="stylesheet" type="text/css"> -->
    <script>
        var socket = io();
        $("#inbox").addClass("active");
        $("#title").text("Indbakke");

        // Admin send message to server
        function adminMessage (userId) {
            const message = $("#message").val();
            $("#message").val("");
            
            $("#messageDiv").append("<p class='text-right'>" + message + "</p>");
            
            socket.emit("from admin to server", {
                message: message,
                userId: userId
            });
        }

        // Admin recieving message from server
        socket.on("from server to admin", (data) => {
            $("#messageDiv").append("<p>" + data.message + "</p>");
        });

    </script>

    <style>
    
    p:not(small) {
        font-size: 20px;
    }

    </style>

    

    <!-- Messages  -->
     <div id="messageDiv" class="container">
        <% user.messages.forEach((message) => { %>
            <% if(message.fromUser === false) { %>            
                <p class="">
                    <span class="text-secondary font-weight-bold">  
                        <small> <%= message.date %> </small> <%= user.firstName %>
                    </span>:  <%= message.message %> 
                </p>
            <% } else { %>
                <p class="">
                    <span class="text-primary font-weight-bold"><small> <%= message.date %> </small> Mikael
                    </span>: <%= message.message %>  
                </p>                    
            <% } %>
        <% }) %>
    </div>

    <!-- tekstfelt & send-knap -->
    <div>
        <div class="d-flex flex-column justify-content-end" style="min-height: calc(100vh - 55px); align-items: flex-end;">
            <div class="input-group stickyBottom">
                <input id="message" class="form-control" type="text" placeholder="skriv en besked...">
                <button class="btn btn-primary" onclick="adminMessage('<%= user._id %>')"><i class="fa fa-telegram fa-lg"></i></button>
            </div> 
        </div>
    </div>